<Queries>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <!-- - - - - - - - - - - - USERTABLE SQL COMMANDS - - - - - - - - - - - - - -->

    <getRiftIdByRiftTag>
        SELECT id FROM usertable WHERE rift_tag = ?;
    </getRiftIdByRiftTag>

    <getUserById>
        SELECT * FROM usertable WHERE id = ?;
    </getUserById>

    <getUserByRiftTag>
        SELECT * FROM usertable WHERE rift_tag = ?;
    </getUserByRiftTag>

    <getNumberFollowingById>
        SELECT COUNT(*)
        FROM following
        WHERE follower_id = ?;
    </getNumberFollowingById>

    <getNumberGamesPlayedByUserId>
        SELECT COUNT(*)
        FROM gamerequest g JOIN riftergame r ON g.session_id = r.id
        WHERE riftee_id = ? AND accepted = 2 AND r.session_time &lt; current_timestamp
    </getNumberGamesPlayedByUserId>

    <getRatingInfoByUserId>
        SELECT COUNT(*), u.?
        FROM userrating r, usertable u
        WHERE r.rift_id = ? AND u.id = ?
        GROUP BY (u.rifter_rating);
    </getRatingInfoByUserId>

    <getFollowersById>
        SELECT *
        FROM following
        WHERE following_id = ?;
    </getFollowersById>

    <getFollowingsById>
        SELECT *
        FROM following
        WHERE follower_id = ?;
    </getFollowingsById>

    <getFollowersAndInfoById>
        SELECT *
        FROM following f JOIN usertable u
        ON f.follower_id = u.id
        WHERE f.following_id = ?;
    </getFollowersAndInfoById>

    <getFollowingsAndInfoById>
        SELECT *
        FROM following f JOIN usertable u
        ON f.following_id = u.id
        WHERE f.follower_id = ?;
    </getFollowingsAndInfoById>

    <getNumberFollowersById>
        SELECT COUNT(*)
        FROM following
        WHERE following_id = ?;
    </getNumberFollowersById>

    <getUserActivity>
        SELECT *
        FROM notification
        WHERE creator_id = ?
    </getUserActivity>

    <getUserNotifications>
        SELECT *
        FROM notification
        WHERE user_id = ?
    </getUserNotifications>

    <getUserActiviyAndUserSession>
        SELECT *
        FROM notification n JOIN riftergame r
        ON n.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE n.creator_id = ?
    </getUserActiviyAndUserSession>

    <getUserAndRifterSessions>
        SELECT *
        FROM riftergame r JOIN game g
        ON r.game_id = g.id
        WHERE host_id = ?
        ORDER BY session_time
    </getUserAndRifterSessions>

    <getGameRequestsAndGameInfoByUserId>
        SELECT *
        FROM gamerequest g JOIN riftergame r
        ON g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE g.riftee_id = ?;
    </getGameRequestsAndGameInfoByUserId>

    <getGameRequestsAndHostInfoByUserId>
        SELECT *
        FROM gamerequest g JOIN usertable u
        ON g.host_id = u.id
        WHERE g.riftee_id = ?;
    </getGameRequestsAndHostInfoByUserId>

    <getGameRequestsAndGameInfoAndHostInfoByUserId>
        SELECT *
        FROM gamerequest g JOIN usertable u
        ON g.host_id = u.id
        JOIN riftergame r
        ON g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE g.riftee_id = ?;
    </getGameRequestsAndGameInfoAndHostInfoByUserId>

    <getRequestsByUser>
        SELECT *
        FROM gamerequest
        WHERE riftee_id = ?;
    </getRequestsByUser>

    <getGameRequestsByUserAndAccepted>
        SELECT *
        FROM gamerequest
        WHERE riftee_id = ? AND accepted = ?;
    </getGameRequestsByUserAndAccepted>

    <getGameRequestsAndGameInfoByUserIdAndAccepted>
        SELECT *
        FROM gamerequest g JOIN riftergame r
        ON g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE g.riftee_id = ? AND accepted = ?
    </getGameRequestsAndGameInfoByUserIdAndAccepted>

    <getGameRequestsAndHostInfoByUserIdAndAccepted>
        SELECT *
        FROM gamerequest g JOIN usertable u
        ON g.host_id = u.id
        WHERE g.riftee_id = ? AND accepted = ?;
    </getGameRequestsAndHostInfoByUserIdAndAccepted>

    <getGameRequestsAndHostInfoAndSessionInfoByUserIdAndAccepted>
        SELECT *
        FROM gamerequest g JOIN usertable u
        ON g.host_id = u.id
        JOIN riftergame r
        ON g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE g.riftee_id = ? AND accepted = ?;
    </getGameRequestsAndHostInfoAndSessionInfoByUserIdAndAccepted>

    <getGameRequestsByUserIdAndAccepted>
        SELECT *
        FROM gamerequest
        WHERE riftee_id = ? AND accepted = ?
    </getGameRequestsByUserIdAndAccepted>

    <getBroadcastNotificationsById>
        SELECT n.id, user_id, notification_type, notification_content, session_id, created_time, creator_id,  us.first_name, us.last_name, us.is_private, us.is_suspended, us.profile_picture_path, us.rift_tag, us.riftee_rating, us.rifter_rating
        FROM usertable us JOIN following f ON us.id = f.follower_id
        JOIN notification n ON f.following_id = n.creator_id,
        WHERE us.id = ? AND n.notification_type = 'New Game';
    </getBroadcastNotificationsById>

    <getSessionBroadcastsByUserId>
        SELECT n.*
        FROM gamerequest g
        JOIN riftergame r
        ON g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        JOIN notification n
        ON r.host_id = n.creator_id
        WHERE g.riftee_id = ? AND (n.notification_type = 'sessionUpdate' OR n.notification_type = 'sessionDeletion') AND r.num_slots != -1;
    </getSessionBroadcastsByUserId>

    <getBroadcastNotificationsForFollower>
        SELECT n.id, user_id, notification_type, notification_content, session_id, created_time, creator_id,  u.first_name, u.last_name, u.is_private, u.is_suspended, u.profile_picture_path, u.rift_tag, u.riftee_rating, u.rifter_rating, u.gender
        FROM usertable us JOIN following f ON us.id = f.follower_id
        JOIN notification n ON f.following_id = n.creator_id
        JOIN usertable u ON f.following_id = u.id
        WHERE us.id = ? AND n.notification_type = 'New Game';
    </getBroadcastNotificationsForFollower>

    <getBraintreeIdFromUserId>
        SELECT braintree_id
        FROM usertable
        WHERE id = ?;
    </getBraintreeIdFromUserId>

    <createUser>
        INSERT INTO usertable
        (first_name, last_name, rift_tag, is_private, is_suspended, auth0_token, braintree_id)
        VALUES(?, ?, ?, false, false, ?, ?);
    </createUser>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <!-- - - - - - - - - - - - RIFTER GAME SQL COMMANDS - - - - - - - - - - - - - -->

    <getRifterGameById>
        SELECT *
        FROM riftergame r JOIN game g
        ON r.game_id = g.id
        WHERE id = ?;
    </getRifterGameById>

    <getGameByHostAndPlayerId>
        SELECT *
        FROM gamerequest g JOIN riftergame r
        ON g.host_id = r.host_id AND g.session_id = r.id
        JOIN game ga
        ON r.game_id = ga.id
        WHERE g.riftee_id = ? AND g.host_id = ? AND r.session_time &lt; current_timestamp;
    </getGameByHostAndPlayerId>

    <getSessionCostBySessionId>
        SELECT session_cost
        FROM riftergame
        WHERE id = ?;
    </getSessionCostBySessionId>

    <getRifterGameAndHostByGameId>
        SELECT *
        FROM riftergame r JOIN game g
        ON r.game_id = g.id
        JOIN usertable u
        ON r.host_id = u.id
        WHERE r.id = ?
    </getRifterGameAndHostByGameId>

    <getRifterSessionByHostIdAndSessionTime>
        SELECT *
        FROM riftergame r JOIN game g
        ON r.game_id = g.id
        WHERE host_id = ? AND session_time = ?
    </getRifterSessionByHostIdAndSessionTime>

    <getSessionPlayersBySessionId>
        SELECT u.*
        FROM gamerequest g JOIN usertable u
        ON g.riftee_id = u.id
        WHERE g.session_id = ? AND g.accepted = 2;
    </getSessionPlayersBySessionId>

    <getRifteeSessionsAndHostInfoByRiftTag>
        SELECT r.*, ga.*, g.accepted, u.*
        FROM usertable us JOIN gamerequest g
        ON us.id = g.riftee_id
        JOIN riftergame r
        ON g.host_id = r.host_id AND g.session_id = r.id
        JOIN game ga
        on r.game_id = ga.id
        JOIN usertable u
        ON r.host_id = u.id
        WHERE us.rift_tag = ?
        ORDER BY session_time;
    </getRifteeSessionsAndHostInfoByRiftTag>

    <getRifterAndRifteeSessionsByRiftTag>
        SELECT r.*, ga.*, g.accepted, u.*
        FROM usertable us JOIN gamerequest g
        ON us.id = g.riftee_id
        JOIN riftergame r
        ON g.host_id = r.host_id AND g.session_id = r.id
        JOIN game ga
        on r.game_id = ga.id
        JOIN usertable u
        ON r.host_id = u.id
        WHERE us.rift_tag = ?
        UNION
        SELECT riftergame.*, game.*, null, usertable.*
        FROM riftergame
        JOIN game
        ON game_id = game.id
        JOIN usertable
        ON host_id = usertable.id
        WHERE rift_tag = ?
        ORDER BY session_time;
    </getRifterAndRifteeSessionsByRiftTag>

    <getRequestStatus>
        SELECT accepted
        FROM gamerequest
        WHERE session_id = ? AND riftee_id = ?
    </getRequestStatus>

    <deleteSession>
        DELETE FROM riftergame
        WHERE id = ?;
    </deleteSession>

    <createGame>
        INSERT INTO riftergame
        (host_id, num_slots, session_cost, title, session_duration, session_time, game_id, console, slots_remaining, created_time)
        VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
    </createGame>

    <createNotification>
        INSERT INTO notification
        (user_id, notification_type, notification_content, session_id, created_time, creator_id)
        VALUES(?, ?, ?, ?, current_timestamp, ?);
    </createNotification>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <!-- - - - - - - - - - - - FOLLOWING SQL COMMANDS - - - - - - - - - - - - - -->

    <isFollowing>
        SELECT *
        FROM usertable u JOIN following f
        ON u.id = f.follower_id
        WHERE u.rift_tag = ? AND f.following_id = ?;
    </isFollowing>

    <follow>
        INSERT INTO following
        (follower_id, following_id, accepted)
        VALUES(?, ?, ?);
    </follow>

    <!-- Named as such because this query can either be used to unfollow or to deny a follow request. The action is the same -->
    <removeFollowing>
        DELETE FROM following
        WHERE follower_id = ? AND following_id = ?;
    </removeFollowing>


    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <!-- - - - - - - - - - - - SEARCH SQL COMMANDS - - - - - - - - - - - - - -->

    <searchUsertable>
        SELECT *
        FROM (
            SELECT u.*, levenshtein(rift_tag, ?, 3, 2, 5) as op, levenshtein(first_name, ?, 3, 2, 5) as op2, CAST(((levenshtein(lower(first_name || ' ' || last_name), lower(?), 3, 2, 5) + levenshtein(first_name || ' ' || last_name, ?, 3,2,5)) / 2.0) as float) as op3
            FROM usertable u
        ) as t
        WHERE op &lt; ? OR op2 &lt; ? OR op3 &lt; ? OR op &lt; (7 + ceil(3*(ln(char_length(t.rift_tag))))) OR op2 &lt; (7 + ceil(3*(ln(char_length(t.first_name))))) OR op3 &lt; (7 + ceil(3*(ln(char_length(t.first_name || ' ' || t.last_name)))))
        ORDER BY LEAST(op, op2, op3)
        LIMIT 25;
    </searchUsertable>

    <searchRifterSession>
        SELECT *
        FROM (
            SELECT r.*, g.*, levenshtein(game, ?, 3, 2, 5) as op, levenshtein(split_part(game, ' ', 1), ?, 3, 2, 5) as op2, levenshtein(rift_tag, ?, 3, 2, 5) as op3, u.*
            FROM riftergame r
            JOIN usertable u
            ON r.host_id = u.id
            JOIN game g
            ON r.game_id = g.id
            ) as t
        WHERE op &lt; ? OR op2 &lt; ? OR op3 &lt; ? OR op &lt; (7 + ceil(3*(0.09697 + ln(char_length(t.game))))) OR op2 &lt; (7 + ceil(3*(0.09697+ ln(char_length(split_part(t.game, ' ', 1)))))) OR op3 &lt; (7 + ceil(3*(0.09697 + ln(char_length(t.rift_tag)))))
        ORDER BY LEAST(op, op2);
    </searchRifterSession>

    <createRating>
        INSERT INTO userrating
        (rift_id, account_type, rating, review, reviewer_id, created_time, review_title)
        VALUES(?, ?, ?, ?, ?, ?, ?);
    </createRating>

    <getUserRatingByIds>
        SELECT *
        FROM userrating
        WHERE rift_id = ? AND reviewer_id = ? AND account_type = ?;
    </getUserRatingByIds>

    <getUserRatingsAndReviewerUsertablesById>
        SELECT *
        FROM userrating r JOIN usertable u
        ON r.reviewer_id = u.id
        WHERE r.rift_id = ?;
    </getUserRatingsAndReviewerUsertablesById>

    <getUserReviewsAndReviewerUsertablesByUserId>
        SELECT *
        FROM userrating r JOIN usertable u
        ON r.rift_id = u.id
        WHERE r.reviewer_id = ?;
    </getUserReviewsAndReviewerUsertablesByUserId>

    <getPlayerUsertablesBySessionId>
        SELECT u.*
        FROM gamerequest g
        JOIN riftergame r
        ON g.session_id = r.id AND g.host_id = r.host_id
        JOIN game ga
        ON r.game_id = ga.id
        JOIN usertable u
        ON g.riftee_id = u.id
        WHERE g.session_id = 40 AND accepted = 2;
    </getPlayerUsertablesBySessionId>

    <!--
        CREATE OR REPLACE FUNCTION create_review()
            RETURNS trigger AS
        $BODY$
        DECLARE
            current_rifter_rating float;
            current_riftee_rating float;
        BEGIN
            SELECT u.rifter_rating into current_rifter_rating
            FROM usertable u
            WHERE id = NEW.rift_id;
            SELECT u.riftee_rating into current_riftee_rating
            FROM usertable u
            WHERE id = NEW.rift_id;
            IF NEW.account_type = true THEN
                IF current_rifter_rating IS NULL THEN
                    current_rifter_rating := 0;
                END IF;
                UPDATE usertable
                SET rifter_rating = n.rifter_rating
                FROM (
                    SELECT ((((COUNT(*) - 1) * current_rifter_rating) + NEW.rating) / COUNT(*)) as rifter_rating
                    FROM usertable u, userrating r
                    WHERE u.id = NEW.rift_id AND r.rift_id = NEW.rift_id
                    GROUP BY (u.rifter_rating)
                    ) as n
                WHERE id = NEW.rift_id;
                RETURN NEW;
            ELSE
                IF current_riftee_rating IS NULL THEN
                    current_riftee_rating := 0;
                END IF;
                UPDATE usertable
                SET riftee_rating = n.riftee_rating
                FROM (
                    SELECT ((((COUNT(*) - 1) * current_riftee_rating) + NEW.rating) / COUNT(*)) as riftee_rating
                    FROM usertable u, userrating r
                    WHERE u.id = NEW.rift_id AND r.rift_id = NEW.rift_id
                    GROUP BY(u.riftee_rating)
                    ) as n
                WHERE id = NEW.rift_id;
                RETURN NEW;
            END IF;
        END;
        $BODY$
        LANGUAGE plpgsql;
   -->

    <getGameRequestBySessionAndRifteeId>
        SELECT *
        FROM gamerequest
        WHERE riftee_id = ? AND session_id = ?;
    </getGameRequestBySessionAndRifteeId>

    <createSessionRequest>
        INSERT INTO gamerequest
        (riftee_id, session_id, accepted, host_id)
        VALUES(?, ?, ?, ?);
    </createSessionRequest>

    <getSessionRequestByRiftTag>
        SELECT g.*
        FROM usertable u JOIN gamerequest g
        ON u.id = g.riftee_id
        WHERE u.rift_tag = ?
    </getSessionRequestByRiftTag>

    <!--
        CREATE OR REPLACE FUNCTION create_game_request_notification()
            RETURNS trigger AS
        $BODY$
        BEGIN
            INSERT INTO notification
            (user_id, notification_type, notification_content, session_id, created_time, creator_id)
            VALUES(NEW.host_id, 'gameRequest',
                (SELECT rift_tag
                FROM gamerequest g JOIN usertable u
                ON g.riftee_id = u.id
                WHERE g.riftee_id = NEW.riftee_id
                LIMIT(1))
            || ' wants to play in session: ' ||
                (SELECT title
                FROM gamerequest g JOIN riftergame r
                ON g.session_id = r.id
                WHERE g.session_id = NEW.session_id
                LIMIT(1)),
            NEW.session_id, current_timestamp, NEW.riftee_id);
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;

    -->

    <!--
        CREATE OR REPLACE FUNCTION create_session_deletion_handler()
            RETURNS trigger AS
        $BODY$
        BEGIN
            INSERT INTO notification
            (user_id, notification_type, notification_content, session_id, created_time, creator_id)
            VALUES(null, 'sessionDeletion',
                (SELECT rift_tag
                FROM usertable u
                WHERE u.id = OLD.host_id
                LIMIT(1))
            || ' has deleted ' ||
                (SELECT OLD.title
                FROM riftergame r
                WHERE r.id = OLD.id
                LIMIT(1)),
            OLD.id, current_timestamp, OLD.host_id);
            DELETE FROM gamerequest
            WHERE session_id = OLD.id;
            RETURN OLD;
        END;
        $BODY$
        LANGUAGE plpgsql;
    -->

    <!--

        CREATE OR REPLACE FUNCTION create_follow_notification()
            RETURNS trigger AS
        $BODY$
        BEGIN
            INSERT INTO notification
            (user_id, notification_type, notification_content, session_id, created_time, creator_id)
            VALUES(NEW.following_id, 'follow',
                (SELECT rift_tag
                FROM following f JOIN usertable u
                ON f.follower_id = u.id
                WHERE f.follower_id = NEW.follower_id
                LIMIT(1))
            || ' has started following you.',
            null, current_timestamp, NEW.follower_id);
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;

    -->

    <!--
        CREATE TRIGGER create_session_update_notification
        AFTER UPDATE
        ON riftergame
        FOR EACH ROW
        WHEN ((NEW.slots_remaining = OLD.slots_remaining OR (NEW.slots_remaining <> OLD.slots_remaining AND NEW.num_slots <> OLD.num_slots)) AND NEW.num_slots <> -1)
        EXECUTE PROCEDURE create_session_update_notification();
    -->

    <!--
        CREATE TRIGGER create_session_update_notification
        BEFORE DELETE
        ON notification
        FOR EACH ROW
        EXECUTE PROCEDURE create_session_deletion_notification();
    -->

    <!--

        CREATE OR REPLACE FUNCTION create_session_update_notification()
            RETURNS trigger AS
        $BODY$
        BEGIN
            INSERT INTO notification
            (user_id, notification_type, notification_content, session_id, created_time, creator_id)
            VALUES(null, 'sessionUpdate',
                (SELECT rift_tag
                FROM riftergame r JOIN usertable u
                ON r.host_id = u.id
                WHERE r.host_id = NEW.host_id
                LIMIT(1))
            || ' has updated ' ||
                (SELECT title
                FROM riftergame r
                WHERE r.id = NEW.id
                LIMIT(1)),
            NEW.id, current_timestamp, NEW.host_id);
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;
    -->

    <!--
        CREATE OR REPLACE FUNCTION create_session_accepted_or_rejected_notification()
            RETURNS trigger AS
        $BODY$
        DECLARE temp integer;
        BEGIN
            IF NEW.accepted = 0 AND OLD.accepted = 1 THEN
                INSERT INTO notification
                (user_id, notification_type, notification_content, session_id, created_time, creator_id)
                VALUES(NEW.riftee_id, 'sessionDenied',
                    (SELECT rift_tag
                    FROM usertable u
                    WHERE u.id = OLD.host_id
                    LIMIT(1))
                || ' has rejected your request to play in ' ||
                    (SELECT OLD.title
                    FROM riftergame r JOIN gamerequest g
                    ON r.id = g.session_id
                    WHERE r.id = OLD.session_id
                    LIMIT(1)),
                OLD.session_id, current_timestamp, NEW.host_id);
            ELSIF NEW.accepted = 2 AND OLD.accepted = 1 THEN
                INSERT INTO notification
                (user_id, notification_type, notification_content, session_id, created_time, creator_id)
                VALUES(NEW.riftee_id, 'sessionAccepted',
                    (SELECT rift_tag
                    FROM gamerequest g JOIN usertable u
                    ON g.host_id = u.id
                    WHERE g.host_id = NEW.host_id
                    LIMIT(1))
                || ' has accepted your request to participate ' ||
                    (SELECT title
                    FROM riftergame r JOIN gamerequest g
                    ON r.id = g.session_id
                    WHERE r.id = NEW.session_id
                    LIMIT(1)),
                NEW.session_id, current_timestamp, NEW.host_id);
            END IF;
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;
    -->

    <!--
        CREATE OR REPLACE FUNCTION update_num_slots_remaining()
            RETURNS trigger AS
        $BODY$
        BEGIN
            IF NEW.accepted = 2 AND OLD.accepted = 1 THEN
                UPDATE riftergame
                SET slots_remaining = slots_remaining - 1
                WHERE id = NEW.session_id;
            END IF;
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;

    -->

    <!--

        CREATE OR REPLACE FUNCTION update_num_slots_remaining_add()
            RETURNS trigger AS
        $BODY$
        BEGIN
            IF (TG_OP = 'UPDATE') THEN
                IF ((NEW.accepted = 0 OR NEW.accepted = 1) AND OLD.accepted = 2) THEN
                    UPDATE riftergame
                    SET slots_remaining = slots_remaining + 1
                    WHERE id = NEW.session_id;
                END IF;
            ELSIF (TG_OP = 'DELETE') THEN
                IF OLD.accepted = 2 THEN
                    UPDATE riftergame
                    SET slots_remaining = slots_remaining + 1
                    WHERE id = OLD.session_id;
                END IF;
            END IF;
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;

    -->

    <!--


        CREATE OR REPLACE FUNCTION create_session_creation_notification()
            RETURNS trigger AS
        $BODY$
        BEGIN
            INSERT INTO notification
            (user_id, notification_type, notification_content, session_id, created_time, creator_id)
            VALUES(null, 'sessionCreated',
                (SELECT rift_tag
                FROM usertable u
                WHERE u.id = NEW.host_id
                LIMIT(1))
            || ' has created a new game for ' ||
                NEW.game,
            NEW.id, current_timestamp, NEW.host_id);
            RETURN NEW;
        END;
        $BODY$
        LANGUAGE plpgsql;

    -->

    <!--

        CREATE OR REPLACE FUNCTION create_session_deletion_notification()
            RETURNS trigger AS
        $BODY$
        BEGIN
            IF (SELECT EXTRACT(EPOCH FROM (OLD.session_time - current_timestamp))) > 360 THEN
                INSERT INTO notification
                (user_id, notification_type, notification_content, session_id, created_time, creator_id)
                SELECT user_id, 'herro', 'herro2', null, current_timestamp, creator_id
                FROM notification
                WHERE session_id = OLD.id;

                DELETE FROM notification
                WHERE session_id = OLD.id;
                RETURN OLD;
            END IF;
        END;
        $BODY$
        LANGUAGE plpgsql;

        CREATE TRIGGER create_session_deletion_notification
        BEFORE DELETE
        ON riftergame
        FOR EACH ROW
        EXECUTE PROCEDURE create_session_deletion_notification();

     -->


</Queries>
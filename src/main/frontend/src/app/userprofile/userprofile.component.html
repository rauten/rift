<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

<div class="container" style="width: 80%" *ngIf="isDataAvailable">
  <base href="/">
  <div class="user-profile">
    <div class="row">
      <div class="profile-header-background"><img src="{{currentUser.coverPhoto}}" alt="Profile Header Background"></div>
      <div class="col-md-4">
        <div class="profile-info-left">
          <div class="text-center">
            <div id="profile-pic">
              <img src="{{currentUser.profilePic}}" class="avatar img-circle" alt="">
            </div>
            <h3>{{currentUser.firstName | capitalize}} {{currentUser.lastName | capitalize}} </h3>
            <h3>@{{currentUser.riftTag}}</h3>
            <h3>{{currentUser.email}}</h3>
            <app-rating [rating]="currentUser.rifterRating" [readonly]="true"></app-rating>
            <div id="following_button" *ngIf="isLoggedIn && profile.nickname != currentUser.riftTag">
              <app-follow-button [following]="isFollowing(currentUser.riftTag)" [id]="currentUser.id"
              [riftTag]="profile.nickname" class="userbtn">
              </app-follow-button>
            </div>
            <div id="update_info_button" *ngIf="isLoggedIn && profile.nickname == currentUser.riftTag">
              <button (click)="openDialog()" type="button" class="btn-primary">Update your Info</button>
            </div>
            <div id="rate_user_button" *ngIf="isLoggedIn && profile.nickname != currentUser.riftTag">
              <button (click)="openRatingDialog()" type="button" class="btn-primary">Rate this User</button>
            </div>
            <br>
            <div id="file_a_complaint" *ngIf="isLoggedIn && profile.nickname == currentUser.riftTag">
              <button (click)="fileAComplaint()" type="button" class="btn-primary">File A Complaint</button>
            </div>
            <alert type="danger" *ngIf="ratingStatus == 0">
              Haven't played with {{currentUser.riftTag}} in past 30 days
            </alert>
            <alert type="danger" *ngIf="ratingStatus == 1">
              Already rated {{currentUser.riftTag}} in past 30 days
            </alert>
            <div>
              <button (click)="verifyWithYouTube()" type="button" class="btn-primary">Verify With YouTube</button>
            </div>
          </div>
          <div class="section about">
            <h3>About Me</h3>
            <p> {{currentUser.bio}} </p>
          </div>
          <div class="section statistics">
            <h3>Statistics</h3>
            <i class="fa fa-twitch"></i>
            <p><span class="badge">{{currentUser.followings?.length}}</span> Following</p>
            <p><span class="badge">{{currentUser.followers?.length}}</span> Followers</p>
            <p><span class="badge">{{currentUser.rifterSessions?.length}}</span> Sessions Played</p>
          </div>
          <div class="section socialmedia">
            <h3>Social</h3>
            <ul class="list-unstyled list-social">
              <li><i class="fa fa-youtube"></i> {{currentUser.youtubeAccount}}</li>
              <li><i class="fa fa-twitch"></i> <a href="https://twitch.tv/{{currentUser.twitchAccount}}">twitch.tv/{{currentUser.twitchAccount}}</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="profile-info-right">
          <mat-tab-group>
            <mat-tab label="activity">
              <div class="media activity-item" *ngFor="let activity of currentUser.activities">
                <a href="#" class="pull-left">
                  <img src="{{currentUser.profilePic}}" alt="Avatar" class="media-object avatar">
                </a>
                <div class="media-body">
                  <p class="activity-title">
                    <a href="#">{{currentUser.riftTag}}</a>
                    {{activity.notificationContent}} <a [routerLink]="['../../session', activity.sessionId]">{{activity.title}}</a>
                  </p>
                  <small class="text-muted">{{activity.createdTime | date:'fullDate'}} at {{activity.createdTime | date:'shortTime'}}</small>
                </div>
                <div class="btn-group pull-right activity-actions">
                  <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown">
                    <i class="fa fa-th"></i>
                    <span class="sr-only">Toggle Dropdown</span>
                  </button>
                </div>
              </div>
            </mat-tab>
            <mat-tab label="sessions">
              <div class="media" *ngFor="let session of currentUser.rifterSessions">
                <app-session-card [routerLink]="['../../session', session.id]"
                                  [session]="session" [isLoggedIn]="isLoggedIn"
                                  [type]="session.type"
                ></app-session-card>
              </div>
            </mat-tab>
            <mat-tab label="followers">
              <div class="media user-follower" *ngFor="let follower of currentUser.followers">
                <img src="{{follower.profilePic}}" alt="User Avatar" class="media-object pull-left">
                <div class="media-body">
                  <a [routerLink]="['../../user', follower.riftTag]">{{follower.firstName}} {{follower.lastName}} {{follower.id}}
                    <br><span class="text-muted username">@{{follower.riftTag}}</span></a>
                  <app-follow-button class="pull-right" [following]="isFollowing(follower.riftTag)" [id]="follower.id"
                                     [riftTag]="profile.nickname" *ngIf="isLoggedIn && profile.nickname != follower.riftTag">
                  </app-follow-button>
                </div>
              </div>
            </mat-tab>
            <mat-tab label="following">
              <div class="media user-following" *ngFor="let following of currentUser.followings">
                  <img src="{{following.profilePic}}" alt="User Avatar" class="media-object pull-left">
                  <div class="media-body">
                    <a [routerLink]="['../../user', following.riftTag]">{{following.firstName}} {{following.lastName}}
                      <br><span class="text-muted username">@{{following.riftTag}}</span></a>
                    <app-follow-button class="pull-right" [following]="isFollowing(following.riftTag)" [id]="following.id"
                                       [riftTag]="profile.nickname" *ngIf="isLoggedIn && profile.nickname != following.riftTag">

                    </app-follow-button>
                  </div>
              </div>
            </mat-tab>
            <mat-tab label="reviews" style="width: 100%;">
              <div class="row" style="text-align:center">
                <div class="col-lg-5">
                  <div class="rating-block">
                    <h4>Average Rifter Rating</h4>
                    <h2 class="bold padding-bottom-7"> {{currentUser.rifterRating}} <small>/ 5</small></h2>
                    <app-rating [rating]="currentUser.rifterRating" [readonly]="true"></app-rating>
                  </div>
                </div>
                <div class="col-lg-5">
                  <div class="rating-block">
                    <h4>Average Riftee Rating</h4>
                    <h2 class="bold padding-bottom-7"> {{currentUser.rifteeRating}} <small>/ 5</small></h2>
                    <app-rating [rating]="currentUser.rifteeRating" [readonly]="true"></app-rating>
                  </div>
                </div>

              </div>
              <div class="row">
                <div class="col-sm-7" *ngFor="let rating of currentUser.ratings">
                    <app-user-review [rating]="rating" ></app-user-review>
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>
</div>
<router-outlet></router-outlet>

<!--<mat-tab label="notifications" *ngIf="isLoggedIn && profile.nickname == currentUser.riftTag">-->
<!--<div class="media" *ngFor="let notification of currentUser.notifications">-->
<!--<app-notification [notification]="notification"></app-notification>-->
<!--</div>-->
<!--</mat-tab>-->


<!--<mat-tab label="feed" *ngIf="isLoggedIn && profile.nickname == currentUser.riftTag">-->
  <!--<div class="media activity-item" *ngFor="let notification of currentUser.feed">-->
    <!--<a href="#" class="pull-left">-->
      <!--<img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="Avatar" class="media-object avatar">-->
    <!--</a>-->
    <!--<div class="media-body">-->
      <!--<p class="activity-title"><a [routerLink]="['../../user',notification.rifttag]">{{notification.riftTag}}</a>-->
        <!--{{notification.notificationContent}} </p>-->
      <!--<small class="text-muted">{{notification.createdTime | date:'fullDate'}} at {{notification.createdTime | date:'shortTime'}}</small>-->
    <!--</div>-->
  <!--</div>-->
<!--</mat-tab>-->
